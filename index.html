<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Form To Google Sheets Demo</title>
  <meta name="description" content="Store HTML form submissions in Google Sheets">
  <link href="favicon.png" rel="shortcut icon">

  <link rel="stylesheet" href="main.css">
  
  
</head>
<body>  
    <div class="wrapper" id="wrap">
		<h1 class="container__title">Заявка на экскурсионный полёт на Марс</h1>
			<div class="container">
				
				<div class="content">
					<div class="content__form">
						<form class="form" id="form" name="submit-to-google-sheet" >
							<div class="form__inputs">
								<div class="input">
									<label for="surname" class="label__left">Фамилия</label>
									<input class="form__input" id="surname" type="text" name="surname" required>
								</div>
								<div class="checkbox"> 
									<div class="check__items">  
										<input id="check" type="checkbox" name="check">
										<label for="check">ранее менялась</label>
									</div>
								</div>
								<div class="input">
									<label for="name" class="label__left">Имя</label>
									<input class="form__input" id="name" name="name" type="text" required>
								</div>
								<div class="input">
								<label for="lastname" class="label__left">Отчество</label>
								<input class="form__input" id="lastname" type="text" name="lastName">
								</div>
								<div class="form__baggage">
									<p class="baggage__text">Если вы не хотите лететь в багажном отсеке, пожалуйста, укажите ваше отчество.</p>
								</div>
								<div class="input">
									<label for="surnamelatin" class="label__left">Фамилия латиницей</label>
									<input class="form__input" id="surnamelatin" type="text" name="surnamelatin" required>
								</div>
								<div class="input">
									<label for="namelatin" class="label__left">Имя латиницей</label>
									<input class="form__input" id="namelatin" type="text" name="namelatin" required>
								</div>
								<div class="input">
									<p class="label__left">Дата рождения</p>
									<select name="select1" required>
										<option selected></option>											
										<option value="2008">2008</option>
											<option value="2007">2007</option>
											<option value="2006">2006</option>
											<option value="2005">2005</option>
											<option value="2004">2004</option>
											<option value="2003">2003</option>
											<option value="2002">2002</option>
											<option value="2001">2001</option>
											<option value="2000">2000</option>
											<option value="1999">1999</option>
											<option value="1998">1998</option>
											<option value="1997">1997</option>
											<option value="1996">1996</option>
											<option value="1995">1995</option>
											<option value="1994">1994</option>
											<option value="1993">1993</option>
											<option value="1992">1992</option>
											<option value="1991">1991</option>
											<option value="1990">1990</option>
											<option value="1989">1989</option>
											<option value="1988">1988</option>
											<option value="1987">1987</option>
											<option value="1986">1986</option>
											<option value="1985">1985</option>
											<option value="1984">1984</option>
											<option value="1983">1983</option>
											<option value="1982">1982</option>
											<option value="1981">1981</option>
											<option value="1980">1980</option>
											<option value="1979">1979</option>
											<option value="1978">1978</option>
											<option value="1977">1977</option>
											<option value="1976">1976</option>
											<option value="1975">1975</option>
											<option value="1974">1974</option>
											<option value="1973">1973</option>
											<option value="1972">1972</option>
											<option value="1971">1971</option>
											<option value="1970">1970</option>
											<option value="1969">1969</option>
											<option value="1968">1968</option>
											<option value="1967">1967</option>
											<option value="1966">1966</option>
											<option value="1965">1965</option>
											<option value="1964">1964</option>
											<option value="1963">1963</option>
											<option value="1962">1962</option>
											<option value="1961">1961</option>
											<option value="1960">1960</option>
											<option value="1959">1959</option>
											<option value="1958">1958</option>
											<option value="1957">1957</option>
											<option value="1956">1956</option>
											<option value="1955">1955</option>
											<option value="1954">1954</option>
											<option value="1953">1953</option>
											<option value="1952">1952</option>
											<option value="1951">1951</option>
											<option value="1950">1950</option>
											<option value="1959">1949</option>
											<option value="1958">1948</option>
											<option value="1957">1947</option>
											<option value="1956">1946</option>
											<option value="1955">1945</option>
											<option value="1954">1944</option>
											<option value="1953">1943</option>
											<option value="1952">1942</option>
											<option value="1951">1941</option>
											<option value="1950">1930</option>
											<option value="1959">1939</option>
											<option value="1958">1938</option>
											<option value="1957">1937</option>
											<option value="1956">1936</option>
											<option value="1955">1935</option>
											<option value="1954">1934</option>
											<option value="1953">1933</option>
											<option value="1952">1932</option>
											<option value="1951">1931</option>
											<option value="1950">1930</option>
											<option value="1959">1929</option>
											<option value="1958">1928</option>
											<option value="1957">1927</option>
											<option value="1956">1926</option>
											<option value="1955">1925</option>
											<option value="1954">1924</option>
											<option value="1953">1923</option>
											<option value="1952">1922</option>
											<option value="1951">1921</option>
											<option value="1950">1920</option>	
									</select>
									<select name="select2" required>
										<option selected></option>
										<option value="01">Январь</option>
										<option value="02">Февраль</option>
										<option value="03">Март</option>
										<option value="04">Апрель</option>
										<option value="05">Май</option>
										<option value="06">Июнь</option>
										<option value="07">Июль</option>
										<option value="08">Август</option>
										<option value="09">Сентябрь</option>
										<option value="10">Октябрь</option>
										<option value="11">Ноябрь</option>
										<option value="12">Декабрь</option>
									</select>
									<select name="select3" required>
										<option selected></option>
										<option value="01">01</option>
										<option value="02">02</option>
										<option value="03">03</option>
										<option value="04">04</option>
										<option value="05">05</option>
										<option value="06">06</option>
										<option value="07">07</option>
										<option value="08">08</option>
										<option value="09">09</option>
										<option value="10">10</option>
										<option value="11">11</option>
										<option value="12">12</option>
										<option value="13">13</option>
										<option value="14">14</option>
										<option value="15">15</option>
										<option value="16">16</option>
										<option value="17">17</option>
										<option value="18">18</option>
										<option value="19">19</option>
										<option value="20">20</option>
										<option value="21">21</option>
										<option value="22">22</option>
										<option value="23">23</option>
										<option value="24">24</option>
										<option value="25">25</option>
										<option value="26">26</option>
										<option value="27">27</option>
										<option value="28">28</option>
										<option value="29">29</option>
										<option value="30">30</option>
										<option value="31">31</option>
									</select>
									
								</div>
								<div class="input">
									<p class="label__left">Пол</p>
									<input id="radio1" type="radio" name="option" checked value="Мужской" required>
									<label for="radio1" class="form__radio form__radio_first">мужской</label>
									<input id="radio2" type="radio" name="option" value="Женский" required>									
									<label for="radio2" class="form__radio form__radio_second">женский</label>
									
								</div>
								
								<div class="input">
									<label for="family" class="label__left">Семейное положение</label>
									<select id="family" name="family" required>
										<option>женат/замужем</option>
										<option>в "гражданском браке"</option>
										<option>разведен/разведена</option>
										<option>холост/не замужем</option>
										<option>вдовец/вдова</option>
									</select>
								</div>
								<div class="input">
									<label for="education" class="label__left">Образование</label>
									<select id="education" name="educ" required>
										<option>высшее</option>
										<option>среднее специальное</option>
										<option>среднее</option>
										<option>студент    </option>
									</select>
								</div>
								<div class="input__contacts">
									<h3 class="title__contacts">Контактная информация </h3>
									<div class="input"> 
										<label for="phone" class="label__left">Моб. телефон</label>
										<input class="form__input" id="phone" name="phone" type="text" required placeholder="+7">
									</div>
									<div class="input">
										<label for="email" class="label__left">Электронная почта</label>
										<input class="form__input" name="email" type="email" required>
									</div>
								</div>
								
							</div>
							<button class="button" type="submit">Полететь на Марс</button>							
						</form>						
					</div>
					<div class="form__button">
								<div class="form__checks">
									<div class="square">
										<input id="check2" type="checkbox" name="check2">
									</div>
									<div class="labl">
										<label for="check2">Ставя эту галочку, я потдверждаю, что поставил её в трезвом уме и твердой памяти</label>									
									</div>
								</div>	
								</div>					
				</div>
				<div class="content__sidebar">
						<h3 class="sidebar__title">Почему стабильно солнечное затмение?</h3>
						<p class="sidebar__text">Эффективный диаметр жизненно вызывает случайный эффективный радиус, а время ожидания ответа составило бы 80 миллиардов лет.</p>
					</div>
			</div>      
		</div>

    <div class="loading js-loading is-hidden">
      <div class="loading-spinner">
        <svg><circle cx="25" cy="25" r="20" fill="none" stroke-width="5" stroke-miterlimit="10"/></svg>
      </div>
    </div>

    <p class="js-success-message is-hidden">Ваши данные отправлены успешно!</p>
    <p class="js-error-message is-hidden">Кажется, произошла какая-то ошибка=/</p>
 

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script src="jquery.maskedinput.js"></script>	
  <script type="text/javascript">
   jQuery(function($){
   $("#phone").mask("+7(999) 999-9999");  
   });
</script>
  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzeBnDhh8o1g7olyvrBjQ2WLVrIITaj64yCFjGPe8tEYY9zf-Ck/exec'
    const form = document.forms['submit-to-google-sheet']
    const loading = document.querySelector('.js-loading')
    const successMessage = document.querySelector('.js-success-message')
    const errorMessage = document.querySelector('.js-error-message')

    form.addEventListener('submit', e => {
      e.preventDefault()
      showLoadingIndicator()
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => showSuccessMessage(response))
        .catch(error => showErrorMessage(error))
    })


	function showLoadingIndicator () {
      form.classList.add('is-hidden')
      loading.classList.remove('is-hidden')
	  document.getElementById('wrap').classList.add('is-hidden');
    }

	    function showSuccessMessage (response) {
      console.log('Success!', response)
      setTimeout(() => {
        successMessage.classList.remove('is-hidden')
        loading.classList.add('is-hidden')
      }, 500)
    }

    function showErrorMessage (error) {
      console.error('Error!', error.message)
      setTimeout(() => {
        errorMessage.classList.remove('is-hidden')
        loading.classList.add('is-hidden')
      }, 500)
    }
  </script>

</body>
</html>
